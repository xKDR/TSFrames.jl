<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic demo of TSx · TSx.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://xKDR.github.io/TSx.jl/demo_finance/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TSx.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Basic demo of TSx</a></li><li><a class="tocitem" href="../user_guide/">User guide</a></li><li><a class="tocitem" href="../api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Basic demo of TSx</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic demo of TSx</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/xKDR/TSx.jl/blob/master/docs/src/demo_finance.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-demo-of-TSx-using-financial-data"><a class="docs-heading-anchor" href="#Basic-demo-of-TSx-using-financial-data">Basic demo of TSx using financial data</a><a id="Basic-demo-of-TSx-using-financial-data-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-demo-of-TSx-using-financial-data" title="Permalink"></a></h1><h3 id="Read-daily-prices-of-IBM-and-AAPL-stocks"><a class="docs-heading-anchor" href="#Read-daily-prices-of-IBM-and-AAPL-stocks">Read daily prices of IBM and AAPL stocks</a><a id="Read-daily-prices-of-IBM-and-AAPL-stocks-1"></a><a class="docs-heading-anchor-permalink" href="#Read-daily-prices-of-IBM-and-AAPL-stocks" title="Permalink"></a></h3><p>As a first step, we read stock data of IBM and Apple for the past one year as a <a href="https://github.com/JuliaData/DataFrames.jl/">DataFrame</a> then we will convert them to TS objects. The stock data files are bundled with the TSx package so there is no need to download them.</p><pre><code class="language-julia hljs">using CSV, DataFrames, Dates, Plots, Statistics, TSx

filename_ibm = joinpath(dirname(pathof(TSx)),
               &quot;..&quot;, &quot;docs&quot;, &quot;src&quot;, &quot;assets&quot;, &quot;IBM.csv&quot;)
filename_aapl = joinpath(dirname(pathof(TSx)),
               &quot;..&quot;, &quot;docs&quot;, &quot;src&quot;, &quot;assets&quot;, &quot;AAPL.csv&quot;)

ibm_df = CSV.read(filename_ibm, DataFrame);
aapl_df = CSV.read(filename_aapl, DataFrame);</code></pre><h3 id="Create-a-TS-object-for-IBM-historical-data"><a class="docs-heading-anchor" href="#Create-a-TS-object-for-IBM-historical-data">Create a TS object for IBM historical data</a><a id="Create-a-TS-object-for-IBM-historical-data-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-TS-object-for-IBM-historical-data" title="Permalink"></a></h3><p>Here, we convert the data frames into TS objects so that later we can use timeseries specific functions on them.</p><pre><code class="language-julia hljs">ibm_ts = TS(ibm_df, :Date)
show(ibm_ts)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(252 x 6) TS with Dates.Date Index

 Index       Open     High     Low      Close    Adj Close  Volume
 Date        Float64  Float64  Float64  Float64  Float64    Int64
─────────────────────────────────────────────────────────────────────
 2021-04-26  136.157  137.314  135.258  135.344    129.028   4927497
 2021-04-27  135.459  136.291  134.56   135.765    129.429   4062664
 2021-04-28  136.635  137.094  135.851  136.711    130.332   3941433
 2021-04-29  137.792  142.199  136.692  137.897    131.462   4554179
 2021-04-30  137.38   137.505  134.369  135.641    129.311   9280321
 2021-05-03  137.486  139.34   137.237  138.384    131.927   5997241
 2021-05-04  138.059  140.143  137.983  139.34     132.838   6642623
 2021-05-05  139.522  139.522  138.595  138.834    132.355   5229895
     ⋮          ⋮        ⋮        ⋮        ⋮         ⋮         ⋮
 2022-04-12  126.42   127.34   125.58   125.98     125.98    2691000
 2022-04-13  125.64   126.67   124.91   126.14     126.14    3064900
 2022-04-14  128.93   130.58   126.38   126.56     126.56    6382800
 2022-04-18  126.6    127.39   125.53   126.17     126.17    4884200
 2022-04-19  126.08   129.4    126.0    129.15     129.15    7971400
 2022-04-20  135.0    139.56   133.38   138.32     138.32   17859200
 2022-04-21  138.23   141.88   137.35   139.85     139.85    9922300
 2022-04-22  139.7    140.44   137.35   138.25     138.25    6505500
                                                     236 rows omitted</code></pre><h3 id="Create-TS-object-for-AAPL"><a class="docs-heading-anchor" href="#Create-TS-object-for-AAPL">Create TS object for AAPL</a><a id="Create-TS-object-for-AAPL-1"></a><a class="docs-heading-anchor-permalink" href="#Create-TS-object-for-AAPL" title="Permalink"></a></h3><pre><code class="language-julia hljs">aapl_ts = TS(aapl_df, :Date)
show(aapl_ts)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(252 x 6) TS with Dates.Date Index

 Index       Open     High     Low      Close    Adj Close  Volume
 Date        Float64  Float64  Float64  Float64  Float64    Int64
──────────────────────────────────────────────────────────────────────
 2021-04-26   134.83   135.06   133.56   134.72    133.924   66905100
 2021-04-27   135.01   135.41   134.11   134.39    133.596   66015800
 2021-04-28   134.31   135.02   133.08   133.58    132.791  107760100
 2021-04-29   136.47   137.07   132.45   133.48    132.691  151101000
 2021-04-30   131.78   133.56   131.07   131.46    130.683  109839500
 2021-05-03   132.04   134.07   131.83   132.54    131.757   75135100
 2021-05-04   131.19   131.49   126.7    127.85    127.095  137564700
 2021-05-05   129.2    130.45   127.97   128.1     127.343   84000900
     ⋮          ⋮        ⋮        ⋮        ⋮         ⋮          ⋮
 2022-04-12   168.02   169.87   166.64   167.66    167.66    79265200
 2022-04-13   167.39   171.04   166.77   170.4     170.4     70618900
 2022-04-14   170.62   171.27   165.04   165.29    165.29    75237500
 2022-04-18   163.92   166.6    163.57   165.07    165.07    69023900
 2022-04-19   165.02   167.82   163.91   167.4     167.4     67723800
 2022-04-20   168.76   168.88   166.1    167.23    167.23    67929800
 2022-04-21   168.91   171.53   165.91   166.42    166.42    87227800
 2022-04-22   166.46   167.87   161.5    161.79    161.79    84775200
                                                      236 rows omitted</code></pre><h3 id="Create-a-6-month-subset-of-stock-data"><a class="docs-heading-anchor" href="#Create-a-6-month-subset-of-stock-data">Create a 6-month subset of stock data</a><a id="Create-a-6-month-subset-of-stock-data-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-6-month-subset-of-stock-data" title="Permalink"></a></h3><p>We would like to compare the stock returns for both the stocks for 6 months starting from June 1, 2021 till December 31, 2021. We use <code>TSx.subset</code> method to create new objects which contain the specified duration of data.</p><pre><code class="language-julia hljs">date_from = Date(2021, 06, 01);
date_to = Date(2021, 12, 31);

ibm = TSx.subset(ibm_ts, date_from, date_to)
show(ibm)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(150 x 6) TS with Dates.Date Index

 Index       Open     High     Low      Close    Adj Close  Volume
 Date        Float64  Float64  Float64  Float64  Float64    Int64
─────────────────────────────────────────────────────────────────────
 2021-06-01  138.623  139.417  137.428  137.849    132.885   2528705
 2021-06-02  138.26   139.34   137.772  139.312    134.295   2915097
 2021-06-03  138.537  139.465  137.706  139.149    134.138   4320608
 2021-06-04  139.579  141.061  139.35   140.937    135.861   3261323
 2021-06-07  141.061  142.199  140.698  141.511    136.414   3621984
 2021-06-08  141.606  143.595  141.606  142.514    137.382   5313785
 2021-06-09  142.476  144.426  142.275  144.044    138.857   5547252
 2021-06-10  144.809  146.119  143.174  143.92     138.737   4977391
     ⋮          ⋮        ⋮        ⋮        ⋮         ⋮         ⋮
 2021-12-21  127.66   129.34   127.66   128.97     127.435   4856000
 2021-12-22  129.06   129.79   127.6    129.75     128.206   3923200
 2021-12-23  130.0    130.96   129.52   130.63     129.075   3649000
 2021-12-27  130.63   131.65   129.95   131.62     130.053   4293900
 2021-12-28  131.6    133.22   131.59   132.63     131.051   3445200
 2021-12-29  132.4    134.21   132.3    133.35     131.763   4239900
 2021-12-30  133.75   134.37   133.33   133.91     132.316   3158100
 2021-12-31  134.0    134.99   133.61   133.66     132.069   3362100
                                                     134 rows omitted</code></pre><pre><code class="language-julia hljs">aapl = TSx.subset(aapl_ts, date_from, date_to)
show(aapl)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(150 x 6) TS with Dates.Date Index

 Index       Open     High     Low      Close    Adj Close  Volume
 Date        Float64  Float64  Float64  Float64  Float64    Int64
──────────────────────────────────────────────────────────────────────
 2021-06-01   125.08   125.35   123.94   124.28    123.756   67637100
 2021-06-02   124.28   125.24   124.05   125.06    124.532   59278900
 2021-06-03   124.68   124.85   123.13   123.54    123.019   76229200
 2021-06-04   124.07   126.16   123.85   125.89    125.359   75169300
 2021-06-07   126.17   126.32   124.83   125.9     125.369   71057600
 2021-06-08   126.6    128.46   126.21   126.74    126.205   74403800
 2021-06-09   127.21   127.75   126.52   127.13    126.594   56877900
 2021-06-10   127.02   128.19   125.94   126.11    125.578   71186400
     ⋮          ⋮        ⋮        ⋮        ⋮         ⋮          ⋮
 2021-12-21   171.56   173.2    169.12   172.99    172.77    91185900
 2021-12-22   173.04   175.86   172.15   175.64    175.417   92135300
 2021-12-23   175.85   176.85   175.27   176.28    176.056   68356600
 2021-12-27   177.09   180.42   177.07   180.33    180.101   74919600
 2021-12-28   180.16   181.33   178.53   179.29    179.062   79144300
 2021-12-29   179.33   180.63   178.14   179.38    179.152   62348900
 2021-12-30   179.47   180.57   178.09   178.2     177.973   59773000
 2021-12-31   178.09   179.23   177.26   177.57    177.344   64062300
                                                      134 rows omitted</code></pre><h3 id="Combine-adjusted-closing-prices-of-both-stocks-into-one-object"><a class="docs-heading-anchor" href="#Combine-adjusted-closing-prices-of-both-stocks-into-one-object">Combine adjusted closing prices of both stocks into one object</a><a id="Combine-adjusted-closing-prices-of-both-stocks-into-one-object-1"></a><a class="docs-heading-anchor-permalink" href="#Combine-adjusted-closing-prices-of-both-stocks-into-one-object" title="Permalink"></a></h3><p>We now join (cbind) both the stocks&#39; data into a single object for further analysis. We use <code>TSx.join</code> to create two columns containing adjusted closing prices of both the stocks. The join happens by comparing the <code>Index</code> values (dates) of the two objects. The resulting object contains two columns with exactly the same dates for which both the objects have data, all the other rows are omitted from the result.</p><pre><code class="language-julia hljs">ibm_aapl = TSx.join(ibm[:, [&quot;Adj Close&quot;]], aapl[:, [&quot;Adj Close&quot;]], JoinBoth)
    # rename the columns using DataFrame API (making sure `Index` is the first col)
rename!(ibm_aapl.coredata, [:Index, :IBM, :AAPL])
show(ibm_aapl)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(150 x 2) TS with Dates.Date Index

 Index       IBM      AAPL
 Date        Float64  Float64
──────────────────────────────
 2021-06-01  132.885  123.756
 2021-06-02  134.295  124.532
 2021-06-03  134.138  123.019
 2021-06-04  135.861  125.359
 2021-06-07  136.414  125.369
 2021-06-08  137.382  126.205
 2021-06-09  138.857  126.594
 2021-06-10  138.737  125.578
     ⋮          ⋮        ⋮
 2021-12-21  127.435  172.77
 2021-12-22  128.206  175.417
 2021-12-23  129.075  176.056
 2021-12-27  130.053  180.101
 2021-12-28  131.051  179.062
 2021-12-29  131.763  179.152
 2021-12-30  132.316  177.973
 2021-12-31  132.069  177.344
              134 rows omitted</code></pre><p>After the <code>join</code> operation the column names are modified because we merged two same-named columns (<code>Adj Close</code>) so we use <code>DataFrames.rename!()</code> method to rename the columns to easily remembered stock names. This is made possible because <code>ibm_appl.coredata</code> is a <code>DataFrame</code> object internally.</p><h3 id="Convert-data-into-weekly-frequency-using-last-values"><a class="docs-heading-anchor" href="#Convert-data-into-weekly-frequency-using-last-values">Convert data into weekly frequency using last values</a><a id="Convert-data-into-weekly-frequency-using-last-values-1"></a><a class="docs-heading-anchor-permalink" href="#Convert-data-into-weekly-frequency-using-last-values" title="Permalink"></a></h3><p>Here, we convert daily stock data into weekly frequency by taking the value with which the trading closed on the last day of the week as the week&#39;s price.</p><pre><code class="language-julia hljs">ibm_aapl_weekly = apply(ibm_aapl, Week, last, last)
show(ibm_aapl_weekly)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(31 x 2) TS with Dates.Date Index

 Index       IBM_last  AAPL_last
 Date        Float64   Float64
─────────────────────────────────
 2021-06-04   135.861    125.359
 2021-06-11   139.419    126.813
 2021-06-18   131.899    129.909
 2021-06-25   135.327    132.548
 2021-07-02   129.042    139.369
 2021-07-09   130.424    144.498
 2021-07-16   128.009    145.772
 2021-07-23   130.258    147.933
     ⋮          ⋮          ⋮
 2021-11-12   117.544    149.799
 2021-11-19   114.669    160.346
 2021-11-26   114.432    156.61
 2021-12-03   117.426    161.634
 2021-12-10   122.613    179.222
 2021-12-17   125.884    170.922
 2021-12-23   129.075    176.056
 2021-12-31   132.069    177.344
                  15 rows omitted</code></pre><h3 id="Compute-weekly-returns-using-the-familiar-log-and-diff-functions"><a class="docs-heading-anchor" href="#Compute-weekly-returns-using-the-familiar-log-and-diff-functions">Compute weekly returns using the familiar <code>log</code> and <code>diff</code> functions</a><a id="Compute-weekly-returns-using-the-familiar-log-and-diff-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-weekly-returns-using-the-familiar-log-and-diff-functions" title="Permalink"></a></h3><p>TSx has specialised functions for computing rolling differences and log of timeseries data. We use both of these to compute weekly log returns of both the stocks.</p><pre><code class="language-julia hljs">ibm_aapl_weekly_returns = diff(log(ibm_aapl_weekly))
rename!(ibm_aapl_weekly_returns.coredata, [:Index, :IBM, :AAPL])
show(ibm_aapl_weekly_returns)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(31 x 2) TS with Dates.Date Index

 Index       IBM               AAPL
 Date        Float64?          Float64?
────────────────────────────────────────────────
 2021-06-04  missing           missing
 2021-06-11        0.0258469         0.0115306
 2021-06-18       -0.0554491         0.0241276
 2021-06-25        0.0256602         0.0201091
 2021-07-02       -0.0475582         0.0501809
 2021-07-09        0.0106556         0.0361353
 2021-07-16       -0.0186868         0.00878221
 2021-07-23        0.0174142         0.0147147
     ⋮              ⋮                 ⋮
 2021-11-12       -0.0250882        -0.00856381
 2021-11-19       -0.0247662         0.0680368
 2021-11-26       -0.00207023       -0.0235706
 2021-12-03        0.0258271         0.0315733
 2021-12-10        0.0432291         0.103288
 2021-12-17        0.0263247        -0.0474147
 2021-12-23        0.0250372         0.0295917
 2021-12-31        0.0229304         0.00729127
                                 15 rows omitted</code></pre><h3 id="Compute-standard-deviation-of-weekly-returns"><a class="docs-heading-anchor" href="#Compute-standard-deviation-of-weekly-returns">Compute standard deviation of weekly returns</a><a id="Compute-standard-deviation-of-weekly-returns-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-standard-deviation-of-weekly-returns" title="Permalink"></a></h3><p>Computing standard deviation is done using the <a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.std"><code>std</code></a> function from <code>Statistics</code> package. The <code>skipmissing</code> is used to skip missing values which may have been generated while computing log returns or were already present in the data.</p><pre><code class="language-julia hljs">ibm_std = std(skipmissing(ibm_aapl_weekly_returns[:, :IBM]))
println(&quot;Weekly standard deviation of IBM: &quot;, ibm_std)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Weekly standard deviation of IBM: 0.03407929622319902</code></pre><pre><code class="language-julia hljs">aapl_std = std(skipmissing(ibm_aapl_weekly_returns[:, :AAPL]))
println(&quot;Weekly standard deviation of AAPL: &quot;, aapl_std)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Weekly standard deviation of AAPL: 0.030582295479398395</code></pre><h3 id="Scatter-plot-of-AAPL-and-IBM"><a class="docs-heading-anchor" href="#Scatter-plot-of-AAPL-and-IBM">Scatter plot of AAPL and IBM</a><a id="Scatter-plot-of-AAPL-and-IBM-1"></a><a class="docs-heading-anchor-permalink" href="#Scatter-plot-of-AAPL-and-IBM" title="Permalink"></a></h3><p>Here, we use the <a href="https://docs.juliaplots.org/latest/tutorial/">Plots</a> package to create a scatter plot with IBM weekly returns on the x-axis and Apple weekly returns on the y-axis.</p><pre><code class="language-julia hljs">plot(ibm_aapl_weekly_returns[:, :AAPL],
    ibm_aapl_weekly_returns[:, :IBM],
    seriestype = :scatter;
    xlabel = &quot;AAPL&quot;,
    ylabel = &quot;IBM&quot;,
    legend = false)</code></pre><p><img src="../ts-plot.svg" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../user_guide/">User guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.16 on <span class="colophon-date" title="Monday 25 April 2022 09:00">Monday 25 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
