<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic demo of TSFrames · TSFrames.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://xKDR.github.io/TSFrames.jl/demo_finance/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TSFrames.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Basic demo of TSFrames</a><ul class="internal"><li><a class="tocitem" href="#Create-a-TSFrame-object-for-IBM-historical-data"><span>Create a TSFrame object for IBM historical data</span></a></li><li><a class="tocitem" href="#Create-TSFrame-object-for-AAPL"><span>Create TSFrame object for AAPL</span></a></li><li><a class="tocitem" href="#Create-a-6-month-subset-of-stock-data"><span>Create a 6-month subset of stock data</span></a></li><li><a class="tocitem" href="#Combine-adjusted-closing-prices-of-both-stocks-into-one-object"><span>Combine adjusted closing prices of both stocks into one object</span></a></li><li><a class="tocitem" href="#Fill-missing-values"><span>Fill missing values</span></a></li><li><a class="tocitem" href="#Convert-data-into-weekly-frequency-using-last-values"><span>Convert data into weekly frequency using last values</span></a></li><li><a class="tocitem" href="#Compute-weekly-returns-using-the-familiar-log-and-diff-functions"><span>Compute weekly returns using the familiar <code>log</code> and <code>diff</code> functions</span></a></li><li><a class="tocitem" href="#Compute-standard-deviation-of-weekly-returns"><span>Compute standard deviation of weekly returns</span></a></li><li><a class="tocitem" href="#Aggregation-and-rolling-window-operations"><span>Aggregation and rolling window operations</span></a></li><li><a class="tocitem" href="#Rolling-regression-with-a-window-of-10"><span>Rolling regression with a window of 10</span></a></li></ul></li><li><a class="tocitem" href="../user_guide/">User guide</a></li><li><a class="tocitem" href="../api/">API reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Basic demo of TSFrames</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic demo of TSFrames</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/xKDR/TSFrames.jl/blob/main/docs/src/demo_finance.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-demo-of-TSFrames-using-financial-data"><a class="docs-heading-anchor" href="#Basic-demo-of-TSFrames-using-financial-data">Basic demo of TSFrames using financial data</a><a id="Basic-demo-of-TSFrames-using-financial-data-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-demo-of-TSFrames-using-financial-data" title="Permalink"></a></h1><h2 id="Create-a-TSFrame-object-for-IBM-historical-data"><a class="docs-heading-anchor" href="#Create-a-TSFrame-object-for-IBM-historical-data">Create a TSFrame object for IBM historical data</a><a id="Create-a-TSFrame-object-for-IBM-historical-data-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-TSFrame-object-for-IBM-historical-data" title="Permalink"></a></h2><p>To load the IBM historical data, we will use the <code>MarketData.yahoo</code> function from <a href="https://github.com/JuliaQuant/MarketData.jl">MarketData.jl</a>, which returns the data in the form of a <code>TimeArray</code>. We just simply pass this on to the <code>TSFrame</code> constructor.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using TSFrames, MarketData, Plots, Statistics, Impute, GLM</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ibm_ts = TSFrame(MarketData.yahoo(:IBM))</code><code class="nohighlight hljs ansi" style="display:block;">13456×6 TSFrame with Date Index
 Index       Open      High      Low       Close     AdjClose   Volume
 Date        Float64   Float64   Float64   Float64   Float64    Float64
──────────────────────────────────────────────────────────────────────────────
 1971-02-08   16.0851   16.336    15.8939   16.2882    3.55486  719648.0
 1971-02-09   16.2882   16.3121   16.1687   16.1807    3.53139  673624.0
 1971-02-10   16.1568   16.1568   15.9775   16.1209    3.51835  648520.0
 1971-02-11   16.1209   16.2285   16.097    16.1926    3.53399  579484.0
 1971-02-12   16.1926   16.2285   16.1329   16.2285    3.54182  382836.0
 1971-02-16   16.2285   16.4197   16.1926   16.3301    3.56399  684084.0
 1971-02-17   16.2703   16.2703   16.0492   16.0851    3.51052  652704.0
 1971-02-18   16.0851   16.1209   15.7385   15.7385    3.43489  822156.0
     ⋮          ⋮         ⋮         ⋮         ⋮          ⋮            ⋮
 2024-06-07  168.18    171.31    168.06    170.01    170.01          3.4755e6
 2024-06-10  169.55    170.76    168.88    170.38    170.38          3.4447e6
 2024-06-11  169.98    170.0     166.81    169.32    169.32          2.9513e6
 2024-06-12  171.35    172.47    168.1     169.0     169.0           3.5227e6
 2024-06-13  169.01    169.59    168.34    169.12    169.12          3.5257e6
 2024-06-14  168.29    169.47    167.23    169.21    169.21          2.7777e6
 2024-06-17  168.76    169.72    167.5     169.5     169.5           3.2388e6
                                                            13441 rows omitted</code></pre><h2 id="Create-TSFrame-object-for-AAPL"><a class="docs-heading-anchor" href="#Create-TSFrame-object-for-AAPL">Create TSFrame object for AAPL</a><a id="Create-TSFrame-object-for-AAPL-1"></a><a class="docs-heading-anchor-permalink" href="#Create-TSFrame-object-for-AAPL" title="Permalink"></a></h2><p>Similarly, we can create a <code>TSFrame</code> object for the AAPL data.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; aapl_ts = TSFrame(MarketData.yahoo(:AAPL))</code><code class="nohighlight hljs ansi" style="display:block;">10969×6 TSFrame with Date Index
 Index       Open        High        Low         Close       AdjClose    Volum ⋯
 Date        Float64     Float64     Float64     Float64     Float64     Float ⋯
────────────────────────────────────────────────────────────────────────────────
 1980-12-12    0.128348    0.128906    0.128348    0.128348    0.099192  4.690 ⋯
 1980-12-15    0.12221     0.12221     0.121652    0.121652    0.094017  1.758
 1980-12-16    0.113281    0.113281    0.112723    0.112723    0.087117  1.057
 1980-12-17    0.115513    0.116071    0.115513    0.115513    0.089273  8.644
 1980-12-18    0.118862    0.11942     0.118862    0.118862    0.091861  7.344 ⋯
 1980-12-19    0.126116    0.126674    0.126116    0.126116    0.097467  4.863
 1980-12-22    0.132254    0.132813    0.132254    0.132254    0.102211  3.736
 1980-12-23    0.137835    0.138393    0.137835    0.137835    0.106524  4.695
     ⋮           ⋮           ⋮           ⋮           ⋮           ⋮           ⋮ ⋱
 2024-06-07  194.65      196.94      194.14      196.89      196.89      5.310 ⋯
 2024-06-10  196.9       197.3       192.15      193.12      193.12      9.726
 2024-06-11  193.65      207.16      193.63      207.15      207.15      1.723
 2024-06-12  207.37      220.2       206.9       213.07      213.07      1.981
 2024-06-13  214.74      216.75      211.6       214.24      214.24      9.786 ⋯
 2024-06-14  213.85      215.17      211.3       212.49      212.49      7.012
 2024-06-17  213.37      218.95      212.72      216.67      216.67      9.360
                                                 1 column and 10954 rows omitted</code></pre><h2 id="Create-a-6-month-subset-of-stock-data"><a class="docs-heading-anchor" href="#Create-a-6-month-subset-of-stock-data">Create a 6-month subset of stock data</a><a id="Create-a-6-month-subset-of-stock-data-1"></a><a class="docs-heading-anchor-permalink" href="#Create-a-6-month-subset-of-stock-data" title="Permalink"></a></h2><p>We would like to compare the stock returns for both the stocks for 6 months starting from June 1, 2021 till December 31, 2021. We use <code>TSFrames.subset</code> method to create new objects which contain the specified duration of data.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; date_from = Date(2021, 06, 01);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; date_to = Date(2021, 12, 31);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ibm = TSFrames.subset(ibm_ts, date_from, date_to)</code><code class="nohighlight hljs ansi" style="display:block;">150×6 TSFrame with Date Index
 Index       Open     High     Low      Close    AdjClose  Volume
 Date        Float64  Float64  Float64  Float64  Float64   Float64
─────────────────────────────────────────────────────────────────────
 2021-06-01  138.623  139.417  137.428  137.849   119.776  2.5287e6
 2021-06-02  138.26   139.34   137.772  139.312   121.047  2.9151e6
 2021-06-03  138.537  139.465  137.706  139.149   120.906  4.32061e6
 2021-06-04  139.579  141.061  139.35   140.937   122.46   3.26132e6
 2021-06-07  141.061  142.199  140.698  141.511   122.958  3.62198e6
 2021-06-08  141.606  143.595  141.606  142.514   123.83   5.31378e6
 2021-06-09  142.476  144.426  142.275  144.044   125.159  5.54725e6
 2021-06-10  144.809  146.119  143.174  143.92    125.051  4.97739e6
     ⋮          ⋮        ⋮        ⋮        ⋮        ⋮          ⋮
 2021-12-22  129.06   129.79   127.6    129.75    115.559  3.9232e6
 2021-12-23  130.0    130.96   129.52   130.63    116.343  3.649e6
 2021-12-27  130.63   131.65   129.95   131.62    117.224  4.2939e6
 2021-12-28  131.6    133.22   131.59   132.63    118.124  3.4452e6
 2021-12-29  132.4    134.21   132.3    133.35    118.765  4.2399e6
 2021-12-30  133.75   134.37   133.33   133.91    119.264  3.1581e6
 2021-12-31  134.0    134.99   133.61   133.66    119.041  3.3621e6
                                                     135 rows omitted</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; aapl = TSFrames.subset(aapl_ts, date_from, date_to)</code><code class="nohighlight hljs ansi" style="display:block;">150×6 TSFrame with Date Index
 Index       Open     High     Low      Close    AdjClose  Volume
 Date        Float64  Float64  Float64  Float64  Float64   Float64
─────────────────────────────────────────────────────────────────────
 2021-06-01   125.08   125.35   123.94   124.28   122.357  6.76371e7
 2021-06-02   124.28   125.24   124.05   125.06   123.125  5.92789e7
 2021-06-03   124.68   124.85   123.13   123.54   121.629  7.62292e7
 2021-06-04   124.07   126.16   123.85   125.89   123.942  7.51693e7
 2021-06-07   126.17   126.32   124.83   125.9    123.952  7.10576e7
 2021-06-08   126.6    128.46   126.21   126.74   124.779  7.44038e7
 2021-06-09   127.21   127.75   126.52   127.13   125.163  5.68779e7
 2021-06-10   127.02   128.19   125.94   126.11   124.159  7.11864e7
     ⋮          ⋮        ⋮        ⋮        ⋮        ⋮          ⋮
 2021-12-22   173.04   175.86   172.15   175.64   173.435  9.21353e7
 2021-12-23   175.85   176.85   175.27   176.28   174.066  6.83566e7
 2021-12-27   177.09   180.42   177.07   180.33   178.066  7.49196e7
 2021-12-28   180.16   181.33   178.53   179.29   177.039  7.91443e7
 2021-12-29   179.33   180.63   178.14   179.38   177.128  6.23489e7
 2021-12-30   179.47   180.57   178.09   178.2    175.962  5.9773e7
 2021-12-31   178.09   179.23   177.26   177.57   175.34   6.40623e7
                                                     135 rows omitted</code></pre><h2 id="Combine-adjusted-closing-prices-of-both-stocks-into-one-object"><a class="docs-heading-anchor" href="#Combine-adjusted-closing-prices-of-both-stocks-into-one-object">Combine adjusted closing prices of both stocks into one object</a><a id="Combine-adjusted-closing-prices-of-both-stocks-into-one-object-1"></a><a class="docs-heading-anchor-permalink" href="#Combine-adjusted-closing-prices-of-both-stocks-into-one-object" title="Permalink"></a></h2><p>We now join (cbind) both the stocks&#39; data into a single object for further analysis. We use <code>TSFrames.join</code> to create two columns containing adjusted closing prices of both the stocks. The join happens by comparing the <code>Index</code> values (dates) of the two objects. The resulting object contains two columns with exactly the same dates for which both the objects have data, all the other rows are omitted from the result.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ibm_aapl = TSFrames.join(ibm[:, [&quot;AdjClose&quot;]], aapl[:, [&quot;AdjClose&quot;]]; jointype=:JoinBoth)</code><code class="nohighlight hljs ansi" style="display:block;">150×2 TSFrame with Date Index
 Index       AdjClose  AdjClose_1
 Date        Float64   Float64
──────────────────────────────────
 2021-06-01   119.776     122.357
 2021-06-02   121.047     123.125
 2021-06-03   120.906     121.629
 2021-06-04   122.46      123.942
 2021-06-07   122.958     123.952
 2021-06-08   123.83      124.779
 2021-06-09   125.159     125.163
 2021-06-10   125.051     124.159
     ⋮          ⋮          ⋮
 2021-12-22   115.559     173.435
 2021-12-23   116.343     174.066
 2021-12-27   117.224     178.066
 2021-12-28   118.124     177.039
 2021-12-29   118.765     177.128
 2021-12-30   119.264     175.962
 2021-12-31   119.041     175.34
                  135 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; TSFrames.rename!(ibm_aapl, [:IBM, :AAPL])</code><code class="nohighlight hljs ansi" style="display:block;">150×2 TSFrame with Date Index
 Index       IBM      AAPL
 Date        Float64  Float64
──────────────────────────────
 2021-06-01  119.776  122.357
 2021-06-02  121.047  123.125
 2021-06-03  120.906  121.629
 2021-06-04  122.46   123.942
 2021-06-07  122.958  123.952
 2021-06-08  123.83   124.779
 2021-06-09  125.159  125.163
 2021-06-10  125.051  124.159
     ⋮          ⋮        ⋮
 2021-12-22  115.559  173.435
 2021-12-23  116.343  174.066
 2021-12-27  117.224  178.066
 2021-12-28  118.124  177.039
 2021-12-29  118.765  177.128
 2021-12-30  119.264  175.962
 2021-12-31  119.041  175.34
              135 rows omitted</code></pre><p>After the <code>join</code> operation the column names are modified because we merged two same-named columns (<code>AdjClose</code>) so we use <code>TSFrames.rename!()</code> method to rename the columns to easily remembered stock names.</p><h2 id="Fill-missing-values"><a class="docs-heading-anchor" href="#Fill-missing-values">Fill missing values</a><a id="Fill-missing-values-1"></a><a class="docs-heading-anchor-permalink" href="#Fill-missing-values" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ibm_aapl = ibm_aapl |&gt; Impute.locf()</code><code class="nohighlight hljs ansi" style="display:block;">150×2 TSFrame with Date Index
 Index       IBM      AAPL
 Date        Float64  Float64
──────────────────────────────
 2021-06-01  119.776  122.357
 2021-06-02  121.047  123.125
 2021-06-03  120.906  121.629
 2021-06-04  122.46   123.942
 2021-06-07  122.958  123.952
 2021-06-08  123.83   124.779
 2021-06-09  125.159  125.163
 2021-06-10  125.051  124.159
     ⋮          ⋮        ⋮
 2021-12-22  115.559  173.435
 2021-12-23  116.343  174.066
 2021-12-27  117.224  178.066
 2021-12-28  118.124  177.039
 2021-12-29  118.765  177.128
 2021-12-30  119.264  175.962
 2021-12-31  119.041  175.34
              135 rows omitted</code></pre><h2 id="Convert-data-into-weekly-frequency-using-last-values"><a class="docs-heading-anchor" href="#Convert-data-into-weekly-frequency-using-last-values">Convert data into weekly frequency using last values</a><a id="Convert-data-into-weekly-frequency-using-last-values-1"></a><a class="docs-heading-anchor-permalink" href="#Convert-data-into-weekly-frequency-using-last-values" title="Permalink"></a></h2><p>Here, we convert daily stock data into weekly frequency by taking the value with which the trading closed on the last day of the week as the week&#39;s price.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ibm_aapl_weekly = to_weekly(ibm_aapl)</code><code class="nohighlight hljs ansi" style="display:block;">31×2 TSFrame with Date Index
 Index       IBM      AAPL
 Date        Float64  Float64
──────────────────────────────
 2021-06-04  122.46   123.942
 2021-06-11  125.666  125.38
 2021-06-18  118.888  128.442
 2021-06-25  121.978  131.051
 2021-07-02  116.312  137.795
 2021-07-09  117.558  142.865
 2021-07-16  115.382  144.125
 2021-07-23  117.409  146.262
     ⋮          ⋮        ⋮
 2021-11-19  103.357  158.534
 2021-11-26  103.144  154.841
 2021-12-03  105.842  159.808
 2021-12-10  110.518  177.197
 2021-12-17  113.466  168.991
 2021-12-23  116.343  174.066
 2021-12-31  119.041  175.34
               16 rows omitted</code></pre><h2 id="Compute-weekly-returns-using-the-familiar-log-and-diff-functions"><a class="docs-heading-anchor" href="#Compute-weekly-returns-using-the-familiar-log-and-diff-functions">Compute weekly returns using the familiar <code>log</code> and <code>diff</code> functions</a><a id="Compute-weekly-returns-using-the-familiar-log-and-diff-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-weekly-returns-using-the-familiar-log-and-diff-functions" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ibm_aapl_weekly_returns = diff(log.(ibm_aapl_weekly))</code><code class="nohighlight hljs ansi" style="display:block;">31×2 TSFrame with Date Index
 Index       IBM_log           AAPL_log
 Date        Float64?          Float64?
────────────────────────────────────────────────
 2021-06-04  missing           missing
 2021-06-11        0.0258467         0.0115306
 2021-06-18       -0.0554489         0.0241277
 2021-06-25        0.0256601         0.0201091
 2021-07-02       -0.0475582         0.0501808
 2021-07-09        0.0106557         0.0361353
 2021-07-16       -0.0186868         0.0087824
 2021-07-23        0.017414          0.0147143
     ⋮              ⋮                 ⋮
 2021-11-19       -0.0247663         0.0680368
 2021-11-26       -0.00207024       -0.0235705
 2021-12-03        0.025827          0.0315733
 2021-12-10        0.0432291         0.103289
 2021-12-17        0.0263248        -0.0474148
 2021-12-23        0.0250372         0.0295916
 2021-12-31        0.0229304         0.00729153
                                 16 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; TSFrames.rename!(ibm_aapl_weekly_returns, [:IBM, :AAPL])</code><code class="nohighlight hljs ansi" style="display:block;">31×2 TSFrame with Date Index
 Index       IBM               AAPL
 Date        Float64?          Float64?
────────────────────────────────────────────────
 2021-06-04  missing           missing
 2021-06-11        0.0258467         0.0115306
 2021-06-18       -0.0554489         0.0241277
 2021-06-25        0.0256601         0.0201091
 2021-07-02       -0.0475582         0.0501808
 2021-07-09        0.0106557         0.0361353
 2021-07-16       -0.0186868         0.0087824
 2021-07-23        0.017414          0.0147143
     ⋮              ⋮                 ⋮
 2021-11-19       -0.0247663         0.0680368
 2021-11-26       -0.00207024       -0.0235705
 2021-12-03        0.025827          0.0315733
 2021-12-10        0.0432291         0.103289
 2021-12-17        0.0263248        -0.0474148
 2021-12-23        0.0250372         0.0295916
 2021-12-31        0.0229304         0.00729153
                                 16 rows omitted</code></pre><h2 id="Compute-standard-deviation-of-weekly-returns"><a class="docs-heading-anchor" href="#Compute-standard-deviation-of-weekly-returns">Compute standard deviation of weekly returns</a><a id="Compute-standard-deviation-of-weekly-returns-1"></a><a class="docs-heading-anchor-permalink" href="#Compute-standard-deviation-of-weekly-returns" title="Permalink"></a></h2><p>Computing standard deviation is done using the <a href="https://docs.julialang.org/en/v1/stdlib/Statistics/#Statistics.std"><code>std</code></a> function from <code>Statistics</code> package. The <code>skipmissing</code> is used to skip missing values which may have been generated while computing log returns or were already present in the data.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ibm_std = std(skipmissing(ibm_aapl_weekly_returns[:, :IBM]))</code><code class="nohighlight hljs ansi" style="display:block;">0.03407927529206861</code></pre><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; aapl_std = std(skipmissing(ibm_aapl_weekly_returns[:, :AAPL]))</code><code class="nohighlight hljs ansi" style="display:block;">0.03058228614973705</code></pre><h3 id="Scatter-plot-of-AAPL-and-IBM"><a class="docs-heading-anchor" href="#Scatter-plot-of-AAPL-and-IBM">Scatter plot of AAPL and IBM</a><a id="Scatter-plot-of-AAPL-and-IBM-1"></a><a class="docs-heading-anchor-permalink" href="#Scatter-plot-of-AAPL-and-IBM" title="Permalink"></a></h3><p>Here, we use the <a href="https://docs.juliaplots.org/latest/tutorial/">Plots</a> package to create a scatter plot with IBM weekly returns on the x-axis and Apple weekly returns on the y-axis.</p><pre><code class="language-julia hljs">plot(ibm_aapl_weekly_returns[:, :AAPL],
    ibm_aapl_weekly_returns[:, :IBM],
    seriestype = :scatter;
    xlabel = &quot;AAPL&quot;,
    ylabel = &quot;IBM&quot;,
    legend = false)</code></pre><p><img src="../ts-plot.svg" alt/></p><h2 id="Aggregation-and-rolling-window-operations"><a class="docs-heading-anchor" href="#Aggregation-and-rolling-window-operations">Aggregation and rolling window operations</a><a id="Aggregation-and-rolling-window-operations-1"></a><a class="docs-heading-anchor-permalink" href="#Aggregation-and-rolling-window-operations" title="Permalink"></a></h2><p>Here, we compute realised volatility of returns of both IBM and Apple stock weekly and bi-monthly. Then, we compute daily returns volatility on a rolling basis with a window size of 10.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; daily_returns = diff(log.(ibm_aapl))</code><code class="nohighlight hljs ansi" style="display:block;">150×2 TSFrame with Date Index
 Index       IBM_log            AAPL_log
 Date        Float64?           Float64?
──────────────────────────────────────────────────
 2021-06-01  missing            missing
 2021-06-02        0.010555           0.00625657
 2021-06-03       -0.00116733        -0.0122287
 2021-06-04        0.012766           0.0188435
 2021-06-07        0.00406164         7.95257e-5
 2021-06-08        0.00706875         0.00664973
 2021-06-09        0.010676           0.00307242
 2021-06-10       -0.000863161       -0.00805564
     ⋮               ⋮                  ⋮
 2021-12-22        0.00602968         0.0152027
 2021-12-23        0.0067595          0.00363699
 2021-12-27        0.00754996         0.022715
 2021-12-28        0.00764433        -0.00578384
 2021-12-29        0.00541388         0.000501747
 2021-12-30        0.00419079        -0.00659973
 2021-12-31       -0.0018686         -0.0035416
                                  135 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rvol = apply(daily_returns, Week(1), std) # Compute the realised volatility</code><code class="nohighlight hljs ansi" style="display:block;">31×2 TSFrame with Date Index
 Index       IBM_log_std       AAPL_log_std
 Date        Float64?          Float64?
────────────────────────────────────────────────
 2021-06-01  missing           missing
 2021-06-07        0.00423143        0.00685027
 2021-06-14        0.00515158        0.0140531
 2021-06-21        0.0135566         0.00849488
 2021-06-28        0.022242          0.00681121
 2021-07-06        0.00774683        0.0123477
 2021-07-12        0.0055471         0.0145983
 2021-07-19        0.00913881        0.020118
     ⋮              ⋮                 ⋮
 2021-11-15        0.00421508        0.0107341
 2021-11-22        0.00524032        0.0175358
 2021-11-29        0.0142161         0.0188586
 2021-12-06        0.00430296        0.0142466
 2021-12-13        0.0139502         0.0249442
 2021-12-20        0.00719009        0.0122395
 2021-12-27        0.00389365        0.0121977
                                 16 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rvol = apply(daily_returns, Month(2), std) # Every two months</code><code class="nohighlight hljs ansi" style="display:block;">4×2 TSFrame with Date Index
 Index       IBM_log_std       AAPL_log_std
 Date        Float64?          Float64?
───────────────────────────────────────────────
 2021-06-01  missing           missing
 2021-08-02        0.00863797        0.0124995
 2021-10-01        0.0187056         0.0131257
 2021-12-01        0.00792972        0.0184033</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rollapply(daily_returns, std, 10) # Compute rolling vols</code><code class="nohighlight hljs ansi" style="display:block;">141×2 TSFrame with Date Index
 Index       rolling_IBM_log_std  rolling_AAPL_log_std
 Date        Float64?             Float64?
───────────────────────────────────────────────────────
 2021-06-14     missing               missing
 2021-06-15           0.00703757            0.0116001
 2021-06-16           0.00777308            0.0115781
 2021-06-17           0.00939336            0.010301
 2021-06-18           0.00965328            0.0105068
 2021-06-21           0.0128876             0.0109086
 2021-06-22           0.0125776             0.0111715
 2021-06-23           0.0121089             0.0114157
     ⋮                ⋮                    ⋮
 2021-12-22           0.0102034             0.0220221
 2021-12-23           0.0102076             0.0220114
 2021-12-27           0.0102131             0.0213968
 2021-12-28           0.00798223            0.0202205
 2021-12-29           0.00799234            0.0199266
 2021-12-30           0.00678748            0.0179653
 2021-12-31           0.00534794            0.0116642
                                       126 rows omitted</code></pre><h2 id="Rolling-regression-with-a-window-of-10"><a class="docs-heading-anchor" href="#Rolling-regression-with-a-window-of-10">Rolling regression with a window of 10</a><a id="Rolling-regression-with-a-window-of-10-1"></a><a class="docs-heading-anchor-permalink" href="#Rolling-regression-with-a-window-of-10" title="Permalink"></a></h2><p>One of the common finance problems is to run a rolling window regression of firm returns over market returns. For doing this, we will use the <code>lm()</code> function from the <code>GLM</code> package. We will create a separate function <code>regress()</code> which would take in the data as an argument and use pre-defined strings to identify the returns columns, pass them to <code>lm()</code>, and return the results.</p><p>We start by downloading the S&amp;P500 daily data from Yahoo Finance, then performing the same steps as above to come to a joined <code>TSFrame</code> object containing daily returns of S&amp;P500 and IBM stock prices. Then, use <code>rollapply()</code> with <code>bycolumn=false</code> to tell <code>rollapply()</code> to pass in the entire <code>TSFrame</code> to the function in one go for each iteration within the window.</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; sp500 = TSFrame(MarketData.yahoo(&quot;^GSPC&quot;));</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sp500_adjclose = TSFrames.subset(sp500, date_from, date_to)[:, [&quot;AdjClose&quot;]]</code><code class="nohighlight hljs ansi" style="display:block;">150×1 TSFrame with Date Index
 Index       AdjClose
 Date        Float64
──────────────────────
 2021-06-01   4202.04
 2021-06-02   4208.12
 2021-06-03   4192.85
 2021-06-04   4229.89
 2021-06-07   4226.52
 2021-06-08   4227.26
 2021-06-09   4219.55
 2021-06-10   4239.18
     ⋮          ⋮
 2021-12-22   4696.56
 2021-12-23   4725.79
 2021-12-27   4791.19
 2021-12-28   4786.35
 2021-12-29   4793.06
 2021-12-30   4778.73
 2021-12-31   4766.18
      135 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ibm_adjclose = ibm[:, [:Index, :AdjClose]]</code><code class="nohighlight hljs ansi" style="display:block;">150×1 TSFrame with Date Index
 Index       AdjClose
 Date        Float64
──────────────────────
 2021-06-01   119.776
 2021-06-02   121.047
 2021-06-03   120.906
 2021-06-04   122.46
 2021-06-07   122.958
 2021-06-08   123.83
 2021-06-09   125.159
 2021-06-10   125.051
     ⋮          ⋮
 2021-12-22   115.559
 2021-12-23   116.343
 2021-12-27   117.224
 2021-12-28   118.124
 2021-12-29   118.765
 2021-12-30   119.264
 2021-12-31   119.041
      135 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sp500_ibm = join(sp500_adjclose, ibm_adjclose, jointype=:JoinBoth)</code><code class="nohighlight hljs ansi" style="display:block;">150×2 TSFrame with Date Index
 Index       AdjClose  AdjClose_1
 Date        Float64   Float64
──────────────────────────────────
 2021-06-01   4202.04     119.776
 2021-06-02   4208.12     121.047
 2021-06-03   4192.85     120.906
 2021-06-04   4229.89     122.46
 2021-06-07   4226.52     122.958
 2021-06-08   4227.26     123.83
 2021-06-09   4219.55     125.159
 2021-06-10   4239.18     125.051
     ⋮          ⋮          ⋮
 2021-12-22   4696.56     115.559
 2021-12-23   4725.79     116.343
 2021-12-27   4791.19     117.224
 2021-12-28   4786.35     118.124
 2021-12-29   4793.06     118.765
 2021-12-30   4778.73     119.264
 2021-12-31   4766.18     119.041
                  135 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sp500_ibm_returns = diff(log.(sp500_ibm))</code><code class="nohighlight hljs ansi" style="display:block;">150×2 TSFrame with Date Index
 Index       AdjClose_log       AdjClose_1_log
 Date        Float64?           Float64?
──────────────────────────────────────────────────
 2021-06-01  missing            missing
 2021-06-02        0.00144589         0.010555
 2021-06-03       -0.0036353         -0.00116733
 2021-06-04        0.0087953          0.012766
 2021-06-07       -0.000797056        0.00406164
 2021-06-08        0.00017501         0.00706875
 2021-06-09       -0.00182553         0.010676
 2021-06-10        0.00464145        -0.000863161
     ⋮               ⋮                  ⋮
 2021-12-22        0.0101287          0.00602968
 2021-12-23        0.00620441         0.0067595
 2021-12-27        0.0137441          0.00754996
 2021-12-28       -0.00101067         0.00764433
 2021-12-29        0.00140091         0.00541388
 2021-12-30       -0.00299423         0.00419079
 2021-12-31       -0.00262963        -0.0018686
                                  135 rows omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; TSFrames.rename!(sp500_ibm_returns, [&quot;SP500&quot;, &quot;IBM&quot;]);</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; function regress(data)
           ll = lm(@formula(SP500 ~ IBM), data)
           co::Real = coef(ll)[coefnames(ll) .== &quot;IBM&quot;][1]
           sd::Real = Statistics.std(residuals(ll))
           return (co, sd)
       end</code><code class="nohighlight hljs ansi" style="display:block;">regress (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rollapply(sp500_ibm_returns, regress, 10, bycolumn=false)</code><code class="nohighlight hljs ansi" style="display:block;">141×1 TSFrame with Date Index
 Index       rolling_regress
 Date        Tuple…
─────────────────────────────────────
 2021-06-14  (0.121122, 0.00357524)
 2021-06-15  (0.162982, 0.00343795)
 2021-06-16  (0.266419, 0.00359776)
 2021-06-17  (0.191826, 0.0034874)
 2021-06-18  (0.265327, 0.00419971)
 2021-06-21  (0.407349, 0.0045372)
 2021-06-22  (0.425808, 0.00470502)
 2021-06-23  (0.494157, 0.00383342)
     ⋮                  ⋮
 2021-12-22  (0.00412288, 0.0118974)
 2021-12-23  (0.00390581, 0.0117623)
 2021-12-27  (0.0408816, 0.0121557)
 2021-12-28  (-0.312519, 0.0113446)
 2021-12-29  (-0.271113, 0.0108816)
 2021-12-30  (0.112458, 0.0102273)
 2021-12-31  (0.968814, 0.00825404)
                     126 rows omitted</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../user_guide/">User guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 18 June 2024 05:37">Tuesday 18 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
